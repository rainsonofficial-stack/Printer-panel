<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Say the Magic Word</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: black;
    color: white;
    overflow-x: hidden;
  }

  /* Password screen */
  #password-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.95);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding-top: 80px;
    z-index: 10;
  }

  #magic-hat {
    font-size: 48px;
    margin-bottom: 20px;
  }

  #password-input {
    background: transparent;
    border: none;
    border-bottom: 2px solid white;
    color: white;
    font-size: 22px;
    text-align: center;
    outline: none;
  }

  #image-container img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* Invisible 3x3 grid */
  #tap-grid {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    z-index: 5;
  }

  #tap-grid div {
    width: 100%;
    height: 100%;
  }
</style>
</head>
<body>

<!-- Magical password gate -->
<div id="password-screen">
  <div id="magic-hat">ðŸŽ©</div>
  <input id="password-input" type="text" placeholder="Say the Magic Word" />
</div>

<!-- Scrollable images -->
<div id="image-container">
  <img src="https://picsum.photos/1080/1500?random=1" />
  <img src="https://picsum.photos/1080/1600?random=2" />
  <img src="https://picsum.photos/1080/1700?random=3" />
  <img src="https://picsum.photos/1080/1800?random=4" />
  <img src="https://picsum.photos/1080/1900?random=5" />
  <img src="https://picsum.photos/1080/2000?random=6" />
</div>

<!-- Invisible 3x3 touch grid -->
<div id="tap-grid"></div>

<script>
const PASSWORD = "MagicRain";
let enteredCode = "";
const grid = document.getElementById("tap-grid");
const passwordScreen = document.getElementById("password-screen");
const input = document.getElementById("password-input");

/* Unlock page */
input.addEventListener("keyup", e => {
  if (e.key === "Enter" && input.value.trim() === PASSWORD) {
    passwordScreen.style.display = "none";
    console.log("Access granted");
  }
});

/* Invisible 3x3 touch tracker */
grid.addEventListener("click", e => {
  const rect = grid.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  const col = Math.floor((x / rect.width) * 3);
  const row = Math.floor((y / rect.height) * 3);
  const num = row * 3 + col + 1;
  if (enteredCode.length < 3) {
    enteredCode += num;
    console.log("recorded", num);
    if (enteredCode.length === 3) {
      sendCode(enteredCode);
    }
  }
});

/* Send code using image beacon (no CORS issues) */
function sendCode(code) {
  const img = new Image();
  img.src = `https://script.google.com/macros/s/AKfycbxbGtdKXfr4U91vymINtxFRa4GDWQ_UBvGR-JdkmqHUHPd6BKbIXDKnrzDMuWWoXq0/exec?user=pots&code=${encodeURIComponent(code)}&t=${Date.now()}`;
  img.onload = () => console.log("Code sent:", code);
}
</script>
</body>
</html>
